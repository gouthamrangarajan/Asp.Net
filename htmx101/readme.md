### htmx 101

#### simple poc to use htmx to load html generated by ASP.Net for user search

##### ASP .Net code

- a simple controller method to send partial view (can be view also)

```C#
public async Task<IActionResult> Filter(){
    var httpClient=new HttpClient();
    IEnumerable<UserViewModel> vm=new List<UserViewModel>();
    var srchTrm="";
    if(Request.QueryString.Value!=null && Request.QueryString.Value.ToLower().Contains("search"))
        srchTrm= Request.Query.First(f=>f.Key=="search").Value.ToString().ToLower();

    _vmCache??=await httpClient.GetFromJsonAsync<IEnumerable<UserViewModel>>("https://jsonplaceholder.typicode.com/users");
    if(_vmCache is not null)
        vm=_vmCache.Where(f=>f.UserName.ToLower().Contains(srchTrm) || f.Name.ToLower().Contains(srchTrm)
                                || f.Website.ToLower().Contains(srchTrm) || f.Phone.Contains(srchTrm));
    return PartialView("/Views/Partials/_UserTable.cshtml",vm);
}
```

- call this controller method using htmx

```html
<form
  hx-get="/home/filter"
  hx-target="#users__table"
  hx-swap="innerHTML"
  class="w-11/12"
>
  <input
    name="search"
    class="appearance-none outline-none w-full py-2 px-4 rounded-sm border border-indigo-600 focus:border-2"
    placeholder="Type & Press Enter to Search..."
  />
  <div class="relative w-full htmx-indicator">
    <div class="absolute top-10 left-0 w-full flex items-center justify-center">
      <img src="~/assets/loader.gif" width="25" height="25" />
    </div>
  </div>
</form>
<div class="w-full h-120 relative" id="users__table">
  <partial name="/Views/Partials/_UserTable.cshtml" model="@Model"></partial>
</div>
```

- script to include in \_layout.cshtml (no additional javascript or jquery is required)

```html
<script
  src="https://unpkg.com/htmx.org@1.9.4"
  integrity="sha384-zUfuhFKKZCbHTY6aRR46gxiqszMk5tcHjsVFxnUo8VMus4kHGVdIYVbOYYNlKmHV"
  crossorigin="anonymous"
></script>
```

- cshtml in \_UsersTable.cshtml

```html
<table class="table-fixed w-full">
  <thead>
    <tr>
      <th class="py-2 px-4 text-left border-b border-gray-300 border-dashed">
        Name
      </th>
      <th class="py-2 px-4 text-left border-b border-gray-300 border-dashed">
        UserName
      </th>
      <th class="py-2 px-4 text-left border-b border-gray-300 border-dashed">
        Phone
      </th>
      <th class="py-2 px-4 text-left border-b border-gray-300 border-dashed">
        Website
      </th>
    </tr>
  </thead>
  <tbody>
    @foreach(var data in Model){
    <tr>
      <td class="py-2 px-4 border-b border-gray-300 border-dashed">
        <div class="flex">
          <span class="animation-slide-down">@data.Name</span>
        </div>
      </td>
      <td class="py-2 px-4 border-b border-gray-300 border-dashed">
        <div class="flex">
          <span class="animation-slide-down">@data.UserName</span>
        </div>
      </td>
      <td class="py-2 px-4 border-b border-gray-300 border-dashed">
        <div class="flex">
          <span class="animation-slide-down break-all">@data.Phone</span>
        </div>
      </td>
      <td class="py-2 px-4 border-b border-gray-300 border-dashed">
        <div class="flex">
          <span class="animation-slide-down">@data.Website</span>
        </div>
      </td>
    </tr>
    }
  </tbody>
</table>
```

- screenshot (notice the focus in input is never lost during search)

![Screenshot](https://github.com/gouthamrangarajan/Asp.Net/blob/master/htmx101/screenshot.gif)
